<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">

		<th:block layout:fragment="customTitle">
			<title>프로젝트 소개</title>
		</th:block>
		
		<th:block layout:fragment="Contents">
		
		<span id="day"></span>
		
		<!-- 단어 추가  -->
		<th:block layout:fragment="addLanguage">
			<div th:replace="fragments/addLanguage :: addLanguage"></div>
		</th:block>
		
		<table class="table table-hover"> 
			<thead>
				<tr>
					<th>요일</th>
					<th>단어/문장</th>
					<th>뜻</th>
					<th>메모</th>
					<th>수정</th>
					<th>삭제</th>
				</tr>
			</thead>	
			<tbody id="languageBody">
			<tr th:if="${#lists.size(word)}>0" th:each="word:${word}">
				<td th:text ="${word.langIdx}" style="display:none;"></td>
				<td th:text ="${word.langRegDate}"></td>
				<td th:text ="${word.langWord}" class="word"></td>
				<td th:text ="${word.langMeaning}" class="meaning"></td>
				<td th:text ="${word.langEtc}" class="memo"></td>
				<td th:text ="${word.langIdx}" class="idx"></td>
				<td><i class="glyphicon glyphicon-erase modifyBtn" data-attr="0"></i></td>
				<td><i class="glyphicon glyphicon-trash"></i></td>
			</tr>
			<tr th:unless="${#lists.size(word)}>0">
				<td colspan="6">외울 단어가 없습니다.</td>
			</tr>
			</tbody>
		</table>
			
		</th:block>
		<th:block layout:fragment="customScript">
		
			<script th:inline="javascript">
				var categoryIdx = /*[[${categoryIdx}]]*/
				//단어추가 시작
				$('#addLanguageBtn').click(function(){
					$.ajax({
						url :'/ajax/addLanguage',
						type : 'post',
						data : {word : $('input[name=langWord]').val(),
								meaning : $('input[name=langMeaning]').val(), 
								memo : $('input[name=langEtc]').val(),
								categoryIdx : categoryIdx},
						success : function(data){
							console.log(data);
							location.reload();
						}
					});
				});
				//단어추가 끝
				//해당 날짜 클릭 시 이벤트 시작
				$(document).on('click','#calendar div',function(){
					var day = $(this).attr('data-day');
					$('#day').text('');
					$('#day').text(day+'일');
					
				 	var date = $(this).attr('data-date');
				 	console.log(date);
			
					$.ajax({
						url : "/ajax/pickDate",
						type : "post",
						data : {pickDate : date , categoryIdx : categoryIdx},
						success : function(data){
							if(data!=""){
								$('#languageBody').children().remove();
								for(var i = 0 ; i<data.length;i++){
									var tr = '<tr>';
										tr +='<td style="display:none" class="code">'+data[i].langIdx+'</td>';
										tr +='<td>'+data[i].langRegDate+'</td>';
										tr +='<td class="word">'+data[i].langWord+'</td>'
										tr +='<td class="meaning">'+data[i].langMeaning+'</td>'
										tr +='<td class="memo">'+data[i].langEtc+'</td>'
										tr +='<td><i class="glyphicon glyphicon-erase modifyBtn" data-attr = "0"></i></td>'
										tr +='<td><i class="glyphicon glyphicon-trash deleteBtn" ></i></td>'
										tr +='</tr>';
								
									$('#languageBody').append(tr);
								}
							}else{
								$('#languageBody').children().remove();
								var tr = '<tr><td colspan="4">해당일에 입력하신 단어가 없습니다.</td></tr>'
								$('#languageBody').append(tr);
						}
					}
						
					});//ajax 끝
				})
			</script>
		
		
		</th:block>
</html>